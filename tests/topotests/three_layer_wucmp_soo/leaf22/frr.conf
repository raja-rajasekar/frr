int lo
  ip addr 10.0.0.22/32

int leaf22-eth0
  no shut
int leaf22-eth1
  no shut
int leaf22-eth2
  no shut
int leaf22-eth3
  no shut
int leaf22-eth4
  ip addr 192.168.22.1/24
  ip addr 10.22.0.1/24
  ip addr 10.22.1.1/24
  ip addr 10.22.2.1/24
  ip addr 10.22.3.1/24
  ip addr 10.22.4.1/24
  ip addr 10.22.5.1/24
  ip addr 10.22.6.1/24
  ip addr 10.22.7.1/24
  ip addr 10.22.8.1/24
  ip addr 10.22.9.1/24
  no shut

# Add static route for aggregate summary
ip route 22.0.0.0/8 lo

route-map wcmp permit 10
  set extcommunity bandwidth num-multipaths

router bgp 65022
   bgp bestpath as-path multipath-relax
   no bgp ebgp-requires-policy
   timers bgp 1 3
   neighbor leaf22-eth0 interface remote-as external
   neighbor leaf22-eth1 interface remote-as external
   neighbor leaf22-eth2 interface remote-as external
   neighbor leaf22-eth3 interface remote-as external
   address-family ipv4 unicast
      redistribute sharp
      redistribute static
      neighbor leaf22-eth0 route-map wcmp out
      neighbor leaf22-eth1 route-map wcmp out
      neighbor leaf22-eth2 route-map wcmp out
      neighbor leaf22-eth3 route-map wcmp out
      aggregate-address 22.0.0.0/8
!
